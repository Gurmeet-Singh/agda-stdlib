<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.AST.Abstraction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Abstractions used in the reflection machinery</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>

<a id="229" class="Symbol">{-#</a> <a id="233" class="Keyword">OPTIONS</a> <a id="241" class="Pragma">--without-K</a> <a id="253" class="Pragma">--safe</a> <a id="260" class="Symbol">#-}</a>

<a id="265" class="Keyword">module</a> <a id="272" href="Reflection.AST.Abstraction.html" class="Module">Reflection.AST.Abstraction</a> <a id="299" class="Keyword">where</a>

<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="333" class="Symbol">as</a> <a id="336" class="Module">List</a> <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="352" class="Symbol">)</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Data.Product.html" class="Module">Data.Product</a> <a id="379" class="Keyword">using</a> <a id="385" class="Symbol">(</a><a id="386" href="Data.Product.Base.html#1109" class="Function Operator">_×_</a><a id="389" class="Symbol">;</a> <a id="391" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="394" class="Symbol">;</a> <a id="396" href="Data.Product.Base.html#2600" class="Function">uncurry</a><a id="403" class="Symbol">;</a> <a id="405" href="Data.Product.Base.html#1491" class="Function Operator">&lt;_,_&gt;</a><a id="410" class="Symbol">)</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Data.String.html" class="Module">Data.String</a> <a id="436" class="Symbol">as</a> <a id="439" class="Module">String</a> <a id="446" class="Keyword">using</a> <a id="452" class="Symbol">(</a><a id="453" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="459" class="Symbol">)</a>
<a id="461" class="Keyword">open</a> <a id="466" class="Keyword">import</a> <a id="473" href="Level.html" class="Module">Level</a>
<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="518" class="Symbol">as</a> <a id="521" class="Module">Dec</a> <a id="525" class="Keyword">using</a> <a id="531" class="Symbol">(</a><a id="532" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a><a id="535" class="Symbol">;</a> <a id="537" href="Relation.Nullary.Decidable.Core.html#2255" class="Function Operator">_×-dec_</a><a id="544" class="Symbol">)</a>
<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="574" class="Keyword">open</a> <a id="579" class="Keyword">import</a> <a id="586" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="625" class="Keyword">private</a>
  <a id="635" class="Keyword">variable</a>
    <a id="648" href="Reflection.AST.Abstraction.html#648" class="Generalizable">a</a> <a id="650" href="Reflection.AST.Abstraction.html#650" class="Generalizable">b</a> <a id="652" class="Symbol">:</a> <a id="654" href="Agda.Primitive.html#597" class="Postulate">Level</a>
    <a id="664" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a> <a id="666" href="Reflection.AST.Abstraction.html#666" class="Generalizable">B</a> <a id="668" class="Symbol">:</a> <a id="670" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="674" href="Reflection.AST.Abstraction.html#648" class="Generalizable">a</a>
    <a id="680" href="Reflection.AST.Abstraction.html#680" class="Generalizable">s</a> <a id="682" href="Reflection.AST.Abstraction.html#682" class="Generalizable">t</a> <a id="684" class="Symbol">:</a> <a id="686" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="697" href="Reflection.AST.Abstraction.html#697" class="Generalizable">x</a> <a id="699" href="Reflection.AST.Abstraction.html#699" class="Generalizable">y</a> <a id="701" class="Symbol">:</a> <a id="703" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a>

<a id="706" class="Comment">------------------------------------------------------------------------</a>
<a id="779" class="Comment">-- Re-exporting the builtins publicly</a>

<a id="818" class="Keyword">open</a> <a id="823" class="Keyword">import</a> <a id="830" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="854" class="Keyword">public</a>
  <a id="863" class="Keyword">using</a> <a id="869" class="Symbol">(</a><a id="870" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a><a id="873" class="Symbol">)</a>

<a id="876" class="Keyword">open</a> <a id="881" href="Agda.Builtin.Reflection.html#3944" class="Module">Abs</a> <a id="885" class="Keyword">public</a>

<a id="893" class="Comment">------------------------------------------------------------------------</a>
<a id="966" class="Comment">-- Operations</a>

<a id="map"></a><a id="981" href="Reflection.AST.Abstraction.html#981" class="Function">map</a> <a id="985" class="Symbol">:</a> <a id="987" class="Symbol">(</a><a id="988" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a> <a id="990" class="Symbol">→</a> <a id="992" href="Reflection.AST.Abstraction.html#666" class="Generalizable">B</a><a id="993" class="Symbol">)</a> <a id="995" class="Symbol">→</a> <a id="997" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1001" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a> <a id="1003" class="Symbol">→</a> <a id="1005" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1009" href="Reflection.AST.Abstraction.html#666" class="Generalizable">B</a>
<a id="1011" href="Reflection.AST.Abstraction.html#981" class="Function">map</a> <a id="1015" href="Reflection.AST.Abstraction.html#1015" class="Bound">f</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1022" href="Reflection.AST.Abstraction.html#1022" class="Bound">s</a> <a id="1024" href="Reflection.AST.Abstraction.html#1024" class="Bound">x</a><a id="1025" class="Symbol">)</a> <a id="1027" class="Symbol">=</a> <a id="1029" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1033" href="Reflection.AST.Abstraction.html#1022" class="Bound">s</a> <a id="1035" class="Symbol">(</a><a id="1036" href="Reflection.AST.Abstraction.html#1015" class="Bound">f</a> <a id="1038" href="Reflection.AST.Abstraction.html#1024" class="Bound">x</a><a id="1039" class="Symbol">)</a>

<a id="1042" class="Comment">------------------------------------------------------------------------</a>
<a id="1115" class="Comment">-- Decidable equality</a>

<a id="abs-injective₁"></a><a id="1138" href="Reflection.AST.Abstraction.html#1138" class="Function">abs-injective₁</a> <a id="1153" class="Symbol">:</a> <a id="1155" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1159" href="Reflection.AST.Abstraction.html#680" class="Generalizable">s</a> <a id="1161" href="Reflection.AST.Abstraction.html#697" class="Generalizable">x</a> <a id="1163" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1165" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1169" href="Reflection.AST.Abstraction.html#682" class="Generalizable">t</a> <a id="1171" href="Reflection.AST.Abstraction.html#699" class="Generalizable">y</a> <a id="1173" class="Symbol">→</a> <a id="1175" href="Reflection.AST.Abstraction.html#680" class="Generalizable">s</a> <a id="1177" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1179" href="Reflection.AST.Abstraction.html#682" class="Generalizable">t</a>
<a id="1181" href="Reflection.AST.Abstraction.html#1138" class="Function">abs-injective₁</a> <a id="1196" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1201" class="Symbol">=</a> <a id="1203" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="abs-injective₂"></a><a id="1209" href="Reflection.AST.Abstraction.html#1209" class="Function">abs-injective₂</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1230" href="Reflection.AST.Abstraction.html#680" class="Generalizable">s</a> <a id="1232" href="Reflection.AST.Abstraction.html#697" class="Generalizable">x</a> <a id="1234" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1236" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1240" href="Reflection.AST.Abstraction.html#682" class="Generalizable">t</a> <a id="1242" href="Reflection.AST.Abstraction.html#699" class="Generalizable">y</a> <a id="1244" class="Symbol">→</a> <a id="1246" href="Reflection.AST.Abstraction.html#697" class="Generalizable">x</a> <a id="1248" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1250" href="Reflection.AST.Abstraction.html#699" class="Generalizable">y</a>
<a id="1252" href="Reflection.AST.Abstraction.html#1209" class="Function">abs-injective₂</a> <a id="1267" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1272" class="Symbol">=</a> <a id="1274" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="abs-injective"></a><a id="1280" href="Reflection.AST.Abstraction.html#1280" class="Function">abs-injective</a> <a id="1294" class="Symbol">:</a> <a id="1296" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1300" href="Reflection.AST.Abstraction.html#680" class="Generalizable">s</a> <a id="1302" href="Reflection.AST.Abstraction.html#697" class="Generalizable">x</a> <a id="1304" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1306" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1310" href="Reflection.AST.Abstraction.html#682" class="Generalizable">t</a> <a id="1312" href="Reflection.AST.Abstraction.html#699" class="Generalizable">y</a> <a id="1314" class="Symbol">→</a> <a id="1316" href="Reflection.AST.Abstraction.html#680" class="Generalizable">s</a> <a id="1318" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1320" href="Reflection.AST.Abstraction.html#682" class="Generalizable">t</a> <a id="1322" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1324" href="Reflection.AST.Abstraction.html#697" class="Generalizable">x</a> <a id="1326" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1328" href="Reflection.AST.Abstraction.html#699" class="Generalizable">y</a>
<a id="1330" href="Reflection.AST.Abstraction.html#1280" class="Function">abs-injective</a> <a id="1344" class="Symbol">=</a> <a id="1346" href="Data.Product.Base.html#1491" class="Function Operator">&lt;</a> <a id="1348" href="Reflection.AST.Abstraction.html#1138" class="Function">abs-injective₁</a> <a id="1363" href="Data.Product.Base.html#1491" class="Function Operator">,</a> <a id="1365" href="Reflection.AST.Abstraction.html#1209" class="Function">abs-injective₂</a> <a id="1380" href="Data.Product.Base.html#1491" class="Function Operator">&gt;</a>

<a id="1383" class="Comment">-- We often need decidability of equality for Abs A when implementing it</a>
<a id="1456" class="Comment">-- for A. Unfortunately ≡-dec makes the termination checker unhappy.</a>
<a id="1525" class="Comment">-- Instead, we can match on both Abs A and use unAbs-dec for an obviously</a>
<a id="1599" class="Comment">-- decreasing recursive call.</a>

<a id="unAbs"></a><a id="1630" href="Reflection.AST.Abstraction.html#1630" class="Function">unAbs</a> <a id="1636" class="Symbol">:</a> <a id="1638" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1642" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a> <a id="1644" class="Symbol">→</a> <a id="1646" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a>
<a id="1648" href="Reflection.AST.Abstraction.html#1630" class="Function">unAbs</a> <a id="1654" class="Symbol">(</a><a id="1655" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1659" href="Reflection.AST.Abstraction.html#1659" class="Bound">s</a> <a id="1661" href="Reflection.AST.Abstraction.html#1661" class="Bound">a</a><a id="1662" class="Symbol">)</a> <a id="1664" class="Symbol">=</a> <a id="1666" href="Reflection.AST.Abstraction.html#1661" class="Bound">a</a>

<a id="unAbs-dec"></a><a id="1669" href="Reflection.AST.Abstraction.html#1669" class="Function">unAbs-dec</a> <a id="1679" class="Symbol">:</a> <a id="1681" class="Symbol">{</a><a id="1682" href="Reflection.AST.Abstraction.html#1682" class="Bound">abs1</a> <a id="1687" href="Reflection.AST.Abstraction.html#1687" class="Bound">abs2</a> <a id="1692" class="Symbol">:</a> <a id="1694" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1698" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a><a id="1699" class="Symbol">}</a> <a id="1701" class="Symbol">→</a> <a id="1703" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1707" class="Symbol">(</a><a id="1708" href="Reflection.AST.Abstraction.html#1630" class="Function">unAbs</a> <a id="1714" href="Reflection.AST.Abstraction.html#1682" class="Bound">abs1</a> <a id="1719" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1721" href="Reflection.AST.Abstraction.html#1630" class="Function">unAbs</a> <a id="1727" href="Reflection.AST.Abstraction.html#1687" class="Bound">abs2</a><a id="1731" class="Symbol">)</a> <a id="1733" class="Symbol">→</a> <a id="1735" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1739" class="Symbol">(</a><a id="1740" href="Reflection.AST.Abstraction.html#1682" class="Bound">abs1</a> <a id="1745" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1747" href="Reflection.AST.Abstraction.html#1687" class="Bound">abs2</a><a id="1751" class="Symbol">)</a>
<a id="1753" href="Reflection.AST.Abstraction.html#1669" class="Function">unAbs-dec</a> <a id="1763" class="Symbol">{</a><a id="1764" class="Argument">abs1</a> <a id="1769" class="Symbol">=</a> <a id="1771" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1775" href="Reflection.AST.Abstraction.html#1775" class="Bound">s</a> <a id="1777" href="Reflection.AST.Abstraction.html#1777" class="Bound">a</a><a id="1778" class="Symbol">}</a> <a id="1780" class="Symbol">{</a><a id="1781" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a> <a id="1785" href="Reflection.AST.Abstraction.html#1785" class="Bound">t</a> <a id="1787" href="Reflection.AST.Abstraction.html#1787" class="Bound">a′</a><a id="1789" class="Symbol">}</a> <a id="1791" href="Reflection.AST.Abstraction.html#1791" class="Bound">a≟a′</a> <a id="1796" class="Symbol">=</a>
  <a id="1800" href="Relation.Nullary.Decidable.Core.html#4779" class="Function">Dec.map′</a> <a id="1809" class="Symbol">(</a><a id="1810" href="Data.Product.Base.html#2600" class="Function">uncurry</a> <a id="1818" class="Symbol">(</a><a id="1819" href="Relation.Binary.PropositionalEquality.Core.html#1381" class="Function">cong₂</a> <a id="1825" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">abs</a><a id="1828" class="Symbol">))</a> <a id="1831" href="Reflection.AST.Abstraction.html#1280" class="Function">abs-injective</a> <a id="1845" class="Symbol">(</a><a id="1846" href="Reflection.AST.Abstraction.html#1775" class="Bound">s</a> <a id="1848" href="Data.String.Properties.html#2285" class="Function Operator">String.≟</a> <a id="1857" href="Reflection.AST.Abstraction.html#1785" class="Bound">t</a> <a id="1859" href="Relation.Nullary.Decidable.Core.html#2255" class="Function Operator">×-dec</a> <a id="1865" href="Reflection.AST.Abstraction.html#1791" class="Bound">a≟a′</a><a id="1869" class="Symbol">)</a>

<a id="≡-dec"></a><a id="1872" href="Reflection.AST.Abstraction.html#1872" class="Function">≡-dec</a> <a id="1878" class="Symbol">:</a> <a id="1880" href="Relation.Binary.Definitions.html#6143" class="Function">DecidableEquality</a> <a id="1898" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a> <a id="1900" class="Symbol">→</a> <a id="1902" href="Relation.Binary.Definitions.html#6143" class="Function">DecidableEquality</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Agda.Builtin.Reflection.html#3944" class="Datatype">Abs</a> <a id="1925" href="Reflection.AST.Abstraction.html#664" class="Generalizable">A</a><a id="1926" class="Symbol">)</a>
<a id="1928" href="Reflection.AST.Abstraction.html#1872" class="Function">≡-dec</a> <a id="1934" href="Reflection.AST.Abstraction.html#1934" class="Bound Operator">_≟_</a> <a id="1938" href="Reflection.AST.Abstraction.html#1938" class="Bound">x</a> <a id="1940" href="Reflection.AST.Abstraction.html#1940" class="Bound">y</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="Reflection.AST.Abstraction.html#1669" class="Function">unAbs-dec</a> <a id="1954" class="Symbol">(</a><a id="1955" href="Reflection.AST.Abstraction.html#1630" class="Function">unAbs</a> <a id="1961" href="Reflection.AST.Abstraction.html#1938" class="Bound">x</a> <a id="1963" href="Reflection.AST.Abstraction.html#1934" class="Bound Operator">≟</a> <a id="1965" href="Reflection.AST.Abstraction.html#1630" class="Function">unAbs</a> <a id="1971" href="Reflection.AST.Abstraction.html#1940" class="Bound">y</a><a id="1972" class="Symbol">)</a>
</pre></body></html>