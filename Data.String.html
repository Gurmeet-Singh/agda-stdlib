<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="284" class="Keyword">using</a> <a id="290" class="Symbol">(</a><a id="291" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="295" class="Symbol">;</a> <a id="297" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="302" class="Symbol">;</a> <a id="304" href="Data.Bool.Properties.html#16542" class="Function">T?</a><a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Char.html" class="Module">Data.Char</a> <a id="330" class="Symbol">as</a> <a id="333" class="Module">Char</a> <a id="338" class="Keyword">using</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="349" class="Symbol">)</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Function.Base.html" class="Module">Function.Base</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="403" class="Symbol">as</a> <a id="406" class="Module">ℕ</a> <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">(</a><a id="415" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="416" class="Symbol">;</a> <a id="418" href="Data.Nat.Base.html#3211" class="Primitive Operator">_∸_</a><a id="421" class="Symbol">;</a> <a id="423" href="Data.Nat.Base.html#4372" class="Function Operator">⌊_/2⌋</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.Nat.Base.html#4499" class="Function Operator">⌈_/2⌉</a><a id="435" class="Symbol">)</a>
<a id="437" class="Keyword">import</a> <a id="444" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="464" class="Symbol">as</a> <a id="467" class="Module">ℕₚ</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="497" class="Symbol">as</a> <a id="500" class="Module">List</a> <a id="505" class="Keyword">using</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="516" class="Symbol">;</a> <a id="518" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="521" class="Symbol">;</a> <a id="523" href="Data.List.Base.html#7375" class="InductiveConstructor">[]</a><a id="525" class="Symbol">;</a> <a id="527" href="Data.List.Base.html#5233" class="Function Operator">[_]</a><a id="530" class="Symbol">)</a>
<a id="532" class="Keyword">open</a> <a id="537" class="Keyword">import</a> <a id="544" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="563" class="Symbol">as</a> <a id="566" class="Module">NE</a> <a id="569" class="Keyword">using</a> <a id="575" class="Symbol">(</a><a id="576" href="Data.List.NonEmpty.Base.html#1281" class="Record">List⁺</a><a id="581" class="Symbol">)</a>
<a id="583" class="Keyword">open</a> <a id="588" class="Keyword">import</a> <a id="595" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="613" href="Data.Nat.Properties.html#7150" class="Function">ℕₚ.≤-totalOrder</a>
<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="677" class="Keyword">using</a> <a id="683" class="Symbol">(</a><a id="684" href="Data.List.Relation.Binary.Pointwise.Base.html#808" class="Datatype">Pointwise</a><a id="693" class="Symbol">)</a>
<a id="695" class="Keyword">open</a> <a id="700" class="Keyword">import</a> <a id="707" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="744" class="Keyword">using</a> <a id="750" class="Symbol">(</a><a id="751" href="Data.List.Relation.Binary.Lex.Core.html#1522" class="Function">Lex-&lt;</a><a id="756" class="Symbol">;</a> <a id="758" href="Data.List.Relation.Binary.Lex.Core.html#1628" class="Function">Lex-≤</a><a id="763" class="Symbol">)</a>
<a id="765" class="Keyword">open</a> <a id="770" class="Keyword">import</a> <a id="777" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="791" class="Symbol">as</a> <a id="794" class="Module">Vec</a> <a id="798" class="Keyword">using</a> <a id="804" class="Symbol">(</a><a id="805" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a><a id="808" class="Symbol">)</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="837" class="Symbol">as</a> <a id="840" class="Module">Char</a> <a id="845" class="Keyword">using</a> <a id="851" class="Symbol">(</a><a id="852" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="856" class="Symbol">)</a>
<a id="858" class="Keyword">import</a> <a id="865" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="886" class="Symbol">as</a> <a id="889" class="Module">Char</a> <a id="894" class="Keyword">using</a> <a id="900" class="Symbol">(</a><a id="901" href="Data.Char.Properties.html#1570" class="Function Operator">_≟_</a><a id="904" class="Symbol">)</a>
<a id="906" class="Keyword">open</a> <a id="911" class="Keyword">import</a> <a id="918" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="939" class="Keyword">using</a> <a id="945" class="Symbol">(</a><a id="946" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="949" class="Symbol">)</a>
<a id="951" class="Keyword">open</a> <a id="956" class="Keyword">import</a> <a id="963" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="1006" class="Keyword">using</a> <a id="1012" class="Symbol">(</a><a id="1013" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1016" class="Symbol">;</a> <a id="1018" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1022" class="Symbol">)</a>
<a id="1024" class="Keyword">open</a> <a id="1029" class="Keyword">import</a> <a id="1036" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1063" class="Keyword">using</a> <a id="1069" class="Symbol">(</a><a id="1070" href="Relation.Nullary.Decidable.Core.html#1560" class="Field">does</a><a id="1074" class="Symbol">)</a>
<a id="1076" class="Keyword">open</a> <a id="1081" class="Keyword">import</a> <a id="1088" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1103" class="Keyword">using</a> <a id="1109" class="Symbol">(</a><a id="1110" href="Relation.Unary.html#1232" class="Function">Pred</a><a id="1114" class="Symbol">;</a> <a id="1116" href="Relation.Unary.html#3806" class="Function">Decidable</a><a id="1125" class="Symbol">)</a>

<a id="1128" class="Keyword">open</a> <a id="1133" class="Keyword">import</a> <a id="1140" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="1178" href="Data.Char.Properties.html#1570" class="Function Operator">Char._≟_</a>



<a id="1190" class="Comment">------------------------------------------------------------------------</a>
<a id="1263" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="1324" class="Keyword">open</a> <a id="1329" class="Keyword">import</a> <a id="1336" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="1353" class="Keyword">public</a>
<a id="1360" class="Keyword">open</a> <a id="1365" class="Keyword">import</a> <a id="1372" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1395" class="Keyword">using</a> <a id="1401" class="Symbol">(</a><a id="1402" href="Data.String.Properties.html#1625" class="Function Operator">_≈?_</a><a id="1406" class="Symbol">;</a> <a id="1408" href="Data.String.Properties.html#2305" class="Function Operator">_≟_</a><a id="1411" class="Symbol">;</a> <a id="1413" href="Data.String.Properties.html#2591" class="Function Operator">_&lt;?_</a><a id="1417" class="Symbol">;</a> <a id="1419" href="Data.String.Properties.html#4370" class="Function Operator">_==_</a><a id="1423" class="Symbol">)</a> <a id="1425" class="Keyword">public</a>

<a id="1433" class="Comment">------------------------------------------------------------------------</a>
<a id="1506" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1531" href="Data.String.html#1531" class="Function">toVec</a> <a id="1537" class="Symbol">:</a> <a id="1539" class="Symbol">(</a><a id="1540" href="Data.String.html#1540" class="Bound">s</a> <a id="1542" class="Symbol">:</a> <a id="1544" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1550" class="Symbol">)</a> <a id="1552" class="Symbol">→</a> <a id="1554" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="1558" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Data.String.Base.html#2464" class="Function">length</a> <a id="1571" href="Data.String.html#1540" class="Bound">s</a><a id="1572" class="Symbol">)</a>
<a id="1574" href="Data.String.html#1531" class="Function">toVec</a> <a id="1580" href="Data.String.html#1580" class="Bound">s</a> <a id="1582" class="Symbol">=</a> <a id="1584" href="Data.Vec.Base.html#8582" class="Function">Vec.fromList</a> <a id="1597" class="Symbol">(</a><a id="1598" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1605" href="Data.String.html#1580" class="Bound">s</a><a id="1606" class="Symbol">)</a>

<a id="fromVec"></a><a id="1609" href="Data.String.html#1609" class="Function">fromVec</a> <a id="1617" class="Symbol">:</a> <a id="1619" class="Symbol">∀</a> <a id="1621" class="Symbol">{</a><a id="1622" href="Data.String.html#1622" class="Bound">n</a><a id="1623" class="Symbol">}</a> <a id="1625" class="Symbol">→</a> <a id="1627" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="1631" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1636" href="Data.String.html#1622" class="Bound">n</a> <a id="1638" class="Symbol">→</a> <a id="1640" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1647" href="Data.String.html#1609" class="Function">fromVec</a> <a id="1655" class="Symbol">=</a> <a id="1657" href="Data.String.Base.html#1566" class="Primitive">fromList</a> <a id="1666" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1668" href="Data.Vec.Base.html#8488" class="Function">Vec.toList</a>


<a id="1681" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1744" href="Data.String.html#1744" class="Function">parensIfSpace</a> <a id="1758" class="Symbol">:</a> <a id="1760" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1767" class="Symbol">→</a> <a id="1769" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1776" href="Data.String.html#1744" class="Function">parensIfSpace</a> <a id="1790" href="Data.String.html#1790" class="Bound">s</a> <a id="1792" class="Keyword">with</a> <a id="1797" href="Relation.Nullary.Decidable.Core.html#1560" class="Field">does</a> <a id="1802" class="Symbol">(</a><a id="1803" class="String">&#39; &#39;</a> <a id="1807" href="Data.List.Membership.DecSetoid.html#827" class="Function Operator">∈?</a> <a id="1810" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1817" href="Data.String.html#1790" class="Bound">s</a><a id="1818" class="Symbol">)</a>
<a id="1820" class="Symbol">...</a> <a id="1824" class="Symbol">|</a> <a id="1826" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>  <a id="1832" class="Symbol">=</a> <a id="1834" href="Data.String.Base.html#2860" class="Function">parens</a> <a id="1841" class="Bound">s</a>
<a id="1843" class="Symbol">...</a> <a id="1847" class="Symbol">|</a> <a id="1849" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1855" class="Symbol">=</a> <a id="1857" class="Bound">s</a>


<a id="1861" class="Comment">------------------------------------------------------------------------</a>
<a id="1934" class="Comment">-- Rectangle</a>

<a id="1948" class="Comment">-- Build a rectangular column by:</a>
<a id="1982" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="2045" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="2113" href="Data.String.html#2113" class="Function">rectangle</a> <a id="2123" class="Symbol">:</a> <a id="2125" class="Symbol">∀</a> <a id="2127" class="Symbol">{</a><a id="2128" href="Data.String.html#2128" class="Bound">n</a><a id="2129" class="Symbol">}</a> <a id="2131" class="Symbol">→</a> <a id="2133" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2137" class="Symbol">(</a><a id="2138" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2140" class="Symbol">→</a> <a id="2142" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2149" class="Symbol">→</a> <a id="2151" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="2157" class="Symbol">)</a> <a id="2159" href="Data.String.html#2128" class="Bound">n</a> <a id="2161" class="Symbol">→</a>
            <a id="2175" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2179" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2186" href="Data.String.html#2128" class="Bound">n</a> <a id="2188" class="Symbol">→</a> <a id="2190" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2194" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2201" href="Data.String.html#2128" class="Bound">n</a>
<a id="2203" href="Data.String.html#2113" class="Function">rectangle</a> <a id="2213" href="Data.String.html#2213" class="Bound">pads</a> <a id="2218" href="Data.String.html#2218" class="Bound">cells</a> <a id="2224" class="Symbol">=</a> <a id="2226" href="Data.Vec.Base.html#3602" class="Function">Vec.zipWith</a> <a id="2238" class="Symbol">(λ</a> <a id="2241" href="Data.String.html#2241" class="Bound">p</a> <a id="2243" href="Data.String.html#2243" class="Bound">c</a> <a id="2245" class="Symbol">→</a> <a id="2247" href="Data.String.html#2241" class="Bound">p</a> <a id="2249" href="Data.String.html#2323" class="Function">width</a> <a id="2255" href="Data.String.html#2243" class="Bound">c</a><a id="2256" class="Symbol">)</a> <a id="2258" href="Data.String.html#2213" class="Bound">pads</a> <a id="2263" href="Data.String.html#2218" class="Bound">cells</a> <a id="2269" class="Keyword">where</a>

  <a id="2278" href="Data.String.html#2278" class="Function">sizes</a> <a id="2284" class="Symbol">=</a> <a id="2286" href="Data.List.Base.html#1620" class="Function">List.map</a> <a id="2295" href="Data.String.Base.html#2464" class="Function">length</a> <a id="2302" class="Symbol">(</a><a id="2303" href="Data.Vec.Base.html#8488" class="Function">Vec.toList</a> <a id="2314" href="Data.String.html#2218" class="Bound">cells</a><a id="2319" class="Symbol">)</a>
  <a id="2323" href="Data.String.html#2323" class="Function">width</a> <a id="2329" class="Symbol">=</a> <a id="2331" href="Data.List.Extrema.html#1945" class="Function">max</a> <a id="2335" class="Number">0</a> <a id="2337" href="Data.String.html#2278" class="Function">sizes</a>

<a id="2344" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2400" href="Data.String.html#2400" class="Function">rectangleˡ</a> <a id="2411" class="Symbol">:</a> <a id="2413" class="Symbol">∀</a> <a id="2415" class="Symbol">{</a><a id="2416" href="Data.String.html#2416" class="Bound">n</a><a id="2417" class="Symbol">}</a> <a id="2419" class="Symbol">→</a> <a id="2421" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2426" class="Symbol">→</a> <a id="2428" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2432" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2439" href="Data.String.html#2416" class="Bound">n</a> <a id="2441" class="Symbol">→</a> <a id="2443" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2447" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2454" href="Data.String.html#2416" class="Bound">n</a>
<a id="2456" href="Data.String.html#2400" class="Function">rectangleˡ</a> <a id="2467" href="Data.String.html#2467" class="Bound">c</a> <a id="2469" class="Symbol">=</a> <a id="2471" href="Data.String.html#2113" class="Function">rectangle</a> <a id="2481" class="Symbol">(</a><a id="2482" href="Data.Vec.Base.html#6404" class="Function">Vec.replicate</a> <a id="2496" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2498" href="Data.String.Base.html#3592" class="Function">padLeft</a> <a id="2506" href="Data.String.html#2467" class="Bound">c</a><a id="2507" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2510" href="Data.String.html#2510" class="Function">rectangleʳ</a> <a id="2521" class="Symbol">:</a> <a id="2523" class="Symbol">∀</a> <a id="2525" class="Symbol">{</a><a id="2526" href="Data.String.html#2526" class="Bound">n</a><a id="2527" class="Symbol">}</a> <a id="2529" class="Symbol">→</a> <a id="2531" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2536" class="Symbol">→</a> <a id="2538" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2542" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2549" href="Data.String.html#2526" class="Bound">n</a> <a id="2551" class="Symbol">→</a> <a id="2553" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2557" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2564" href="Data.String.html#2526" class="Bound">n</a>
<a id="2566" href="Data.String.html#2510" class="Function">rectangleʳ</a> <a id="2577" href="Data.String.html#2577" class="Bound">c</a> <a id="2579" class="Symbol">=</a> <a id="2581" href="Data.String.html#2113" class="Function">rectangle</a> <a id="2591" class="Symbol">(</a><a id="2592" href="Data.Vec.Base.html#6404" class="Function">Vec.replicate</a> <a id="2606" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2608" href="Data.String.Base.html#3711" class="Function">padRight</a> <a id="2617" href="Data.String.html#2577" class="Bound">c</a><a id="2618" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2621" href="Data.String.html#2621" class="Function">rectangleᶜ</a> <a id="2632" class="Symbol">:</a> <a id="2634" class="Symbol">∀</a> <a id="2636" class="Symbol">{</a><a id="2637" href="Data.String.html#2637" class="Bound">n</a><a id="2638" class="Symbol">}</a> <a id="2640" class="Symbol">→</a> <a id="2642" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2647" class="Symbol">→</a> <a id="2649" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2654" class="Symbol">→</a> <a id="2656" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2660" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2667" href="Data.String.html#2637" class="Bound">n</a> <a id="2669" class="Symbol">→</a> <a id="2671" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2675" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2682" href="Data.String.html#2637" class="Bound">n</a>
<a id="2684" href="Data.String.html#2621" class="Function">rectangleᶜ</a> <a id="2695" href="Data.String.html#2695" class="Bound">cₗ</a> <a id="2698" href="Data.String.html#2698" class="Bound">cᵣ</a> <a id="2701" class="Symbol">=</a> <a id="2703" href="Data.String.html#2113" class="Function">rectangle</a> <a id="2713" class="Symbol">(</a><a id="2714" href="Data.Vec.Base.html#6404" class="Function">Vec.replicate</a> <a id="2728" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2730" href="Data.String.Base.html#3832" class="Function">padBoth</a> <a id="2738" href="Data.String.html#2695" class="Bound">cₗ</a> <a id="2741" href="Data.String.html#2698" class="Bound">cᵣ</a><a id="2743" class="Symbol">)</a>
</pre></body></html>