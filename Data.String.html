<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="284" class="Keyword">using</a> <a id="290" class="Symbol">(</a><a id="291" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="295" class="Symbol">;</a> <a id="297" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="302" class="Symbol">;</a> <a id="304" href="Data.Bool.Properties.html#16542" class="Function">T?</a><a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Char.html" class="Module">Data.Char</a> <a id="330" class="Symbol">as</a> <a id="333" class="Module">Char</a> <a id="338" class="Keyword">using</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="349" class="Symbol">)</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Function.Base.html" class="Module">Function.Base</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="403" class="Symbol">as</a> <a id="406" class="Module">ℕ</a> <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">(</a><a id="415" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="416" class="Symbol">;</a> <a id="418" href="Data.Nat.Base.html#3211" class="Primitive Operator">_∸_</a><a id="421" class="Symbol">;</a> <a id="423" href="Data.Nat.Base.html#4372" class="Function Operator">⌊_/2⌋</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.Nat.Base.html#4499" class="Function Operator">⌈_/2⌉</a><a id="435" class="Symbol">)</a>
<a id="437" class="Keyword">import</a> <a id="444" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="464" class="Symbol">as</a> <a id="467" class="Module">ℕₚ</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="497" class="Symbol">as</a> <a id="500" class="Module">List</a> <a id="505" class="Keyword">using</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="516" class="Symbol">;</a> <a id="518" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="521" class="Symbol">;</a> <a id="523" href="Data.List.Base.html#7375" class="InductiveConstructor">[]</a><a id="525" class="Symbol">;</a> <a id="527" href="Data.List.Base.html#5233" class="Function Operator">[_]</a><a id="530" class="Symbol">)</a>
<a id="532" class="Keyword">open</a> <a id="537" class="Keyword">import</a> <a id="544" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="563" class="Symbol">as</a> <a id="566" class="Module">NE</a> <a id="569" class="Keyword">using</a> <a id="575" class="Symbol">(</a><a id="576" href="Data.List.NonEmpty.Base.html#1281" class="Record">List⁺</a><a id="581" class="Symbol">)</a>
<a id="583" class="Keyword">open</a> <a id="588" class="Keyword">import</a> <a id="595" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="613" href="Data.Nat.Properties.html#7150" class="Function">ℕₚ.≤-totalOrder</a>
<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="Data.List.Relation.Binary.Pointwise.Base.html" class="Module">Data.List.Relation.Binary.Pointwise.Base</a> <a id="682" class="Keyword">using</a> <a id="688" class="Symbol">(</a><a id="689" href="Data.List.Relation.Binary.Pointwise.Base.html#808" class="Datatype">Pointwise</a><a id="698" class="Symbol">)</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="749" class="Keyword">using</a> <a id="755" class="Symbol">(</a><a id="756" href="Data.List.Relation.Binary.Lex.Core.html#1524" class="Function">Lex-&lt;</a><a id="761" class="Symbol">;</a> <a id="763" href="Data.List.Relation.Binary.Lex.Core.html#1630" class="Function">Lex-≤</a><a id="768" class="Symbol">)</a>
<a id="770" class="Keyword">open</a> <a id="775" class="Keyword">import</a> <a id="782" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="796" class="Symbol">as</a> <a id="799" class="Module">Vec</a> <a id="803" class="Keyword">using</a> <a id="809" class="Symbol">(</a><a id="810" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a><a id="813" class="Symbol">)</a>
<a id="815" class="Keyword">open</a> <a id="820" class="Keyword">import</a> <a id="827" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="842" class="Symbol">as</a> <a id="845" class="Module">Char</a> <a id="850" class="Keyword">using</a> <a id="856" class="Symbol">(</a><a id="857" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="861" class="Symbol">)</a>
<a id="863" class="Keyword">import</a> <a id="870" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="891" class="Symbol">as</a> <a id="894" class="Module">Char</a> <a id="899" class="Keyword">using</a> <a id="905" class="Symbol">(</a><a id="906" href="Data.Char.Properties.html#1575" class="Function Operator">_≟_</a><a id="909" class="Symbol">)</a>
<a id="911" class="Keyword">open</a> <a id="916" class="Keyword">import</a> <a id="923" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="944" class="Keyword">using</a> <a id="950" class="Symbol">(</a><a id="951" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="954" class="Symbol">)</a>
<a id="956" class="Keyword">open</a> <a id="961" class="Keyword">import</a> <a id="968" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="1011" class="Keyword">using</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1021" class="Symbol">;</a> <a id="1023" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1027" class="Symbol">)</a>
<a id="1029" class="Keyword">open</a> <a id="1034" class="Keyword">import</a> <a id="1041" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1068" class="Keyword">using</a> <a id="1074" class="Symbol">(</a><a id="1075" href="Relation.Nullary.Decidable.Core.html#1560" class="Field">does</a><a id="1079" class="Symbol">)</a>
<a id="1081" class="Keyword">open</a> <a id="1086" class="Keyword">import</a> <a id="1093" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1108" class="Keyword">using</a> <a id="1114" class="Symbol">(</a><a id="1115" href="Relation.Unary.html#1232" class="Function">Pred</a><a id="1119" class="Symbol">;</a> <a id="1121" href="Relation.Unary.html#3806" class="Function">Decidable</a><a id="1130" class="Symbol">)</a>

<a id="1133" class="Keyword">open</a> <a id="1138" class="Keyword">import</a> <a id="1145" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="1183" href="Data.Char.Properties.html#1575" class="Function Operator">Char._≟_</a>



<a id="1195" class="Comment">------------------------------------------------------------------------</a>
<a id="1268" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="1329" class="Keyword">open</a> <a id="1334" class="Keyword">import</a> <a id="1341" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="1358" class="Keyword">public</a>
<a id="1365" class="Keyword">open</a> <a id="1370" class="Keyword">import</a> <a id="1377" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1400" class="Keyword">using</a> <a id="1406" class="Symbol">(</a><a id="1407" href="Data.String.Properties.html#1625" class="Function Operator">_≈?_</a><a id="1411" class="Symbol">;</a> <a id="1413" href="Data.String.Properties.html#2306" class="Function Operator">_≟_</a><a id="1416" class="Symbol">;</a> <a id="1418" href="Data.String.Properties.html#2592" class="Function Operator">_&lt;?_</a><a id="1422" class="Symbol">;</a> <a id="1424" href="Data.String.Properties.html#4371" class="Function Operator">_==_</a><a id="1428" class="Symbol">)</a> <a id="1430" class="Keyword">public</a>

<a id="1438" class="Comment">------------------------------------------------------------------------</a>
<a id="1511" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1536" href="Data.String.html#1536" class="Function">toVec</a> <a id="1542" class="Symbol">:</a> <a id="1544" class="Symbol">(</a><a id="1545" href="Data.String.html#1545" class="Bound">s</a> <a id="1547" class="Symbol">:</a> <a id="1549" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1555" class="Symbol">)</a> <a id="1557" class="Symbol">→</a> <a id="1559" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="1563" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Data.String.Base.html#2464" class="Function">length</a> <a id="1576" href="Data.String.html#1545" class="Bound">s</a><a id="1577" class="Symbol">)</a>
<a id="1579" href="Data.String.html#1536" class="Function">toVec</a> <a id="1585" href="Data.String.html#1585" class="Bound">s</a> <a id="1587" class="Symbol">=</a> <a id="1589" href="Data.Vec.Base.html#8582" class="Function">Vec.fromList</a> <a id="1602" class="Symbol">(</a><a id="1603" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1610" href="Data.String.html#1585" class="Bound">s</a><a id="1611" class="Symbol">)</a>

<a id="fromVec"></a><a id="1614" href="Data.String.html#1614" class="Function">fromVec</a> <a id="1622" class="Symbol">:</a> <a id="1624" class="Symbol">∀</a> <a id="1626" class="Symbol">{</a><a id="1627" href="Data.String.html#1627" class="Bound">n</a><a id="1628" class="Symbol">}</a> <a id="1630" class="Symbol">→</a> <a id="1632" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="1636" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1641" href="Data.String.html#1627" class="Bound">n</a> <a id="1643" class="Symbol">→</a> <a id="1645" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1652" href="Data.String.html#1614" class="Function">fromVec</a> <a id="1660" class="Symbol">=</a> <a id="1662" href="Data.String.Base.html#1566" class="Primitive">fromList</a> <a id="1671" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1673" href="Data.Vec.Base.html#8488" class="Function">Vec.toList</a>


<a id="1686" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1749" href="Data.String.html#1749" class="Function">parensIfSpace</a> <a id="1763" class="Symbol">:</a> <a id="1765" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1772" class="Symbol">→</a> <a id="1774" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1781" href="Data.String.html#1749" class="Function">parensIfSpace</a> <a id="1795" href="Data.String.html#1795" class="Bound">s</a> <a id="1797" class="Keyword">with</a> <a id="1802" href="Relation.Nullary.Decidable.Core.html#1560" class="Field">does</a> <a id="1807" class="Symbol">(</a><a id="1808" class="String">&#39; &#39;</a> <a id="1812" href="Data.List.Membership.DecSetoid.html#827" class="Function Operator">∈?</a> <a id="1815" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1822" href="Data.String.html#1795" class="Bound">s</a><a id="1823" class="Symbol">)</a>
<a id="1825" class="Symbol">...</a> <a id="1829" class="Symbol">|</a> <a id="1831" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>  <a id="1837" class="Symbol">=</a> <a id="1839" href="Data.String.Base.html#2860" class="Function">parens</a> <a id="1846" class="Bound">s</a>
<a id="1848" class="Symbol">...</a> <a id="1852" class="Symbol">|</a> <a id="1854" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1860" class="Symbol">=</a> <a id="1862" class="Bound">s</a>


<a id="1866" class="Comment">------------------------------------------------------------------------</a>
<a id="1939" class="Comment">-- Rectangle</a>

<a id="1953" class="Comment">-- Build a rectangular column by:</a>
<a id="1987" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="2050" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="2118" href="Data.String.html#2118" class="Function">rectangle</a> <a id="2128" class="Symbol">:</a> <a id="2130" class="Symbol">∀</a> <a id="2132" class="Symbol">{</a><a id="2133" href="Data.String.html#2133" class="Bound">n</a><a id="2134" class="Symbol">}</a> <a id="2136" class="Symbol">→</a> <a id="2138" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2142" class="Symbol">(</a><a id="2143" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2145" class="Symbol">→</a> <a id="2147" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2154" class="Symbol">→</a> <a id="2156" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="2162" class="Symbol">)</a> <a id="2164" href="Data.String.html#2133" class="Bound">n</a> <a id="2166" class="Symbol">→</a>
            <a id="2180" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2184" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2191" href="Data.String.html#2133" class="Bound">n</a> <a id="2193" class="Symbol">→</a> <a id="2195" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2199" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2206" href="Data.String.html#2133" class="Bound">n</a>
<a id="2208" href="Data.String.html#2118" class="Function">rectangle</a> <a id="2218" href="Data.String.html#2218" class="Bound">pads</a> <a id="2223" href="Data.String.html#2223" class="Bound">cells</a> <a id="2229" class="Symbol">=</a> <a id="2231" href="Data.Vec.Base.html#3602" class="Function">Vec.zipWith</a> <a id="2243" class="Symbol">(λ</a> <a id="2246" href="Data.String.html#2246" class="Bound">p</a> <a id="2248" href="Data.String.html#2248" class="Bound">c</a> <a id="2250" class="Symbol">→</a> <a id="2252" href="Data.String.html#2246" class="Bound">p</a> <a id="2254" href="Data.String.html#2328" class="Function">width</a> <a id="2260" href="Data.String.html#2248" class="Bound">c</a><a id="2261" class="Symbol">)</a> <a id="2263" href="Data.String.html#2218" class="Bound">pads</a> <a id="2268" href="Data.String.html#2223" class="Bound">cells</a> <a id="2274" class="Keyword">where</a>

  <a id="2283" href="Data.String.html#2283" class="Function">sizes</a> <a id="2289" class="Symbol">=</a> <a id="2291" href="Data.List.Base.html#1620" class="Function">List.map</a> <a id="2300" href="Data.String.Base.html#2464" class="Function">length</a> <a id="2307" class="Symbol">(</a><a id="2308" href="Data.Vec.Base.html#8488" class="Function">Vec.toList</a> <a id="2319" href="Data.String.html#2223" class="Bound">cells</a><a id="2324" class="Symbol">)</a>
  <a id="2328" href="Data.String.html#2328" class="Function">width</a> <a id="2334" class="Symbol">=</a> <a id="2336" href="Data.List.Extrema.html#1933" class="Function">max</a> <a id="2340" class="Number">0</a> <a id="2342" href="Data.String.html#2283" class="Function">sizes</a>

<a id="2349" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2405" href="Data.String.html#2405" class="Function">rectangleˡ</a> <a id="2416" class="Symbol">:</a> <a id="2418" class="Symbol">∀</a> <a id="2420" class="Symbol">{</a><a id="2421" href="Data.String.html#2421" class="Bound">n</a><a id="2422" class="Symbol">}</a> <a id="2424" class="Symbol">→</a> <a id="2426" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2431" class="Symbol">→</a> <a id="2433" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2437" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2444" href="Data.String.html#2421" class="Bound">n</a> <a id="2446" class="Symbol">→</a> <a id="2448" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2452" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2459" href="Data.String.html#2421" class="Bound">n</a>
<a id="2461" href="Data.String.html#2405" class="Function">rectangleˡ</a> <a id="2472" href="Data.String.html#2472" class="Bound">c</a> <a id="2474" class="Symbol">=</a> <a id="2476" href="Data.String.html#2118" class="Function">rectangle</a> <a id="2486" class="Symbol">(</a><a id="2487" href="Data.Vec.Base.html#6404" class="Function">Vec.replicate</a> <a id="2501" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2503" href="Data.String.Base.html#3592" class="Function">padLeft</a> <a id="2511" href="Data.String.html#2472" class="Bound">c</a><a id="2512" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2515" href="Data.String.html#2515" class="Function">rectangleʳ</a> <a id="2526" class="Symbol">:</a> <a id="2528" class="Symbol">∀</a> <a id="2530" class="Symbol">{</a><a id="2531" href="Data.String.html#2531" class="Bound">n</a><a id="2532" class="Symbol">}</a> <a id="2534" class="Symbol">→</a> <a id="2536" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2541" class="Symbol">→</a> <a id="2543" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2547" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2554" href="Data.String.html#2531" class="Bound">n</a> <a id="2556" class="Symbol">→</a> <a id="2558" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2562" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2569" href="Data.String.html#2531" class="Bound">n</a>
<a id="2571" href="Data.String.html#2515" class="Function">rectangleʳ</a> <a id="2582" href="Data.String.html#2582" class="Bound">c</a> <a id="2584" class="Symbol">=</a> <a id="2586" href="Data.String.html#2118" class="Function">rectangle</a> <a id="2596" class="Symbol">(</a><a id="2597" href="Data.Vec.Base.html#6404" class="Function">Vec.replicate</a> <a id="2611" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2613" href="Data.String.Base.html#3711" class="Function">padRight</a> <a id="2622" href="Data.String.html#2582" class="Bound">c</a><a id="2623" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2626" href="Data.String.html#2626" class="Function">rectangleᶜ</a> <a id="2637" class="Symbol">:</a> <a id="2639" class="Symbol">∀</a> <a id="2641" class="Symbol">{</a><a id="2642" href="Data.String.html#2642" class="Bound">n</a><a id="2643" class="Symbol">}</a> <a id="2645" class="Symbol">→</a> <a id="2647" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2652" class="Symbol">→</a> <a id="2654" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2659" class="Symbol">→</a> <a id="2661" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2665" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2672" href="Data.String.html#2642" class="Bound">n</a> <a id="2674" class="Symbol">→</a> <a id="2676" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2680" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2687" href="Data.String.html#2642" class="Bound">n</a>
<a id="2689" href="Data.String.html#2626" class="Function">rectangleᶜ</a> <a id="2700" href="Data.String.html#2700" class="Bound">cₗ</a> <a id="2703" href="Data.String.html#2703" class="Bound">cᵣ</a> <a id="2706" class="Symbol">=</a> <a id="2708" href="Data.String.html#2118" class="Function">rectangle</a> <a id="2718" class="Symbol">(</a><a id="2719" href="Data.Vec.Base.html#6404" class="Function">Vec.replicate</a> <a id="2733" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2735" href="Data.String.Base.html#3832" class="Function">padBoth</a> <a id="2743" href="Data.String.html#2700" class="Bound">cₗ</a> <a id="2746" href="Data.String.html#2703" class="Bound">cᵣ</a><a id="2748" class="Symbol">)</a>
</pre></body></html>