<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Text.Regex.String.Unsafe</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Regular expressions acting on strings, using unsafe features</a>
<a id="170" class="Comment">------------------------------------------------------------------------</a>

<a id="244" class="Symbol">{-#</a> <a id="248" class="Keyword">OPTIONS</a> <a id="256" class="Pragma">--with-K</a> <a id="265" class="Symbol">#-}</a>

<a id="270" class="Keyword">module</a> <a id="277" href="Text.Regex.String.Unsafe.html" class="Module">Text.Regex.String.Unsafe</a> <a id="302" class="Keyword">where</a>

<a id="309" class="Keyword">open</a> <a id="314" class="Keyword">import</a> <a id="321" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="338" class="Keyword">using</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="351" class="Symbol">;</a> <a id="353" href="Data.String.Base.html#1533" class="Primitive">toList</a><a id="359" class="Symbol">;</a> <a id="361" href="Data.String.Base.html#1566" class="Primitive">fromList</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">import</a> <a id="378" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="397" class="Symbol">as</a> <a id="400" class="Module">Stringₚ</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Function.Base.html" class="Module">Function.Base</a> <a id="434" class="Keyword">using</a> <a id="440" class="Symbol">(</a><a id="441" href="Function.Base.html#6226" class="Function Operator">_on_</a><a id="445" class="Symbol">;</a> <a id="447" href="Function.Base.html#704" class="Function">id</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Level.html" class="Module">Level</a> <a id="469" class="Keyword">using</a> <a id="475" class="Symbol">(</a><a id="476" href="Level.html#521" class="Function">0ℓ</a><a id="478" class="Symbol">)</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="508" class="Keyword">using</a> <a id="514" class="Symbol">(</a><a id="515" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="518" class="Symbol">;</a> <a id="520" href="Relation.Binary.Definitions.html#5914" class="Function">Decidable</a><a id="529" class="Symbol">)</a>
<a id="531" class="Keyword">open</a> <a id="536" class="Keyword">import</a> <a id="543" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="586" class="Keyword">using</a> <a id="592" class="Symbol">(</a><a id="593" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="596" class="Symbol">;</a> <a id="598" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a><a id="601" class="Symbol">;</a> <a id="603" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a><a id="608" class="Symbol">)</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="649" class="Keyword">using</a> <a id="655" class="Symbol">(</a><a id="656" href="Relation.Nullary.Decidable.Core.html#4793" class="Function">map′</a><a id="660" class="Symbol">)</a>

<a id="663" class="Comment">------------------------------------------------------------------------</a>
<a id="736" class="Comment">-- Re-exporting safe definitions</a>

<a id="770" class="Keyword">open</a> <a id="775" class="Keyword">import</a> <a id="782" href="Text.Regex.String.html" class="Module">Text.Regex.String</a> <a id="800" class="Symbol">as</a> <a id="803" class="Module">Regex</a> <a id="809" class="Keyword">public</a>
  <a id="818" class="Keyword">hiding</a> <a id="825" class="Symbol">(</a><a id="826" href="Text.Regex.Base.html#2223" class="Datatype Operator">_∈_</a><a id="829" class="Symbol">;</a> <a id="831" href="Text.Regex.Base.html#2744" class="Function Operator">_∉_</a><a id="834" class="Symbol">;</a> <a id="836" href="Text.Regex.Derivative.Brzozowski.html#4530" class="Function Operator">_∈?_</a><a id="840" class="Symbol">;</a> <a id="842" href="Text.Regex.Derivative.Brzozowski.html#4647" class="Function Operator">_∉?_</a><a id="846" class="Symbol">;</a> <a id="848" href="Text.Regex.Search.html#1863" class="Function">Span</a><a id="852" class="Symbol">;</a> <a id="854" href="Text.Regex.Search.html#2502" class="Record">Match</a><a id="859" class="Symbol">;</a> <a id="861" href="Text.Regex.Search.html#9314" class="Function">search</a><a id="867" class="Symbol">)</a>

<a id="870" class="Comment">------------------------------------------------------------------------</a>
<a id="943" class="Comment">-- Specialised definitions</a>

<a id="_∈_"></a><a id="971" href="Text.Regex.String.Unsafe.html#971" class="Function Operator">_∈_</a> <a id="975" class="Symbol">:</a> <a id="977" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="984" class="Symbol">→</a> <a id="986" href="Text.Regex.Base.html#1113" class="Datatype">Exp</a> <a id="990" class="Symbol">→</a> <a id="992" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="996" href="Text.Regex.String.Unsafe.html#996" class="Bound">str</a> <a id="1000" href="Text.Regex.String.Unsafe.html#971" class="Function Operator">∈</a> <a id="1002" href="Text.Regex.String.Unsafe.html#1002" class="Bound">e</a> <a id="1004" class="Symbol">=</a> <a id="1006" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1013" href="Text.Regex.String.Unsafe.html#996" class="Bound">str</a> <a id="1017" href="Text.Regex.Base.html#2223" class="Datatype Operator">Regex.∈</a> <a id="1025" href="Text.Regex.String.Unsafe.html#1002" class="Bound">e</a>

<a id="_∉_"></a><a id="1028" href="Text.Regex.String.Unsafe.html#1028" class="Function Operator">_∉_</a> <a id="1032" class="Symbol">:</a> <a id="1034" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1041" class="Symbol">→</a> <a id="1043" href="Text.Regex.Base.html#1113" class="Datatype">Exp</a> <a id="1047" class="Symbol">→</a> <a id="1049" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="1053" href="Text.Regex.String.Unsafe.html#1053" class="Bound">str</a> <a id="1057" href="Text.Regex.String.Unsafe.html#1028" class="Function Operator">∉</a> <a id="1059" href="Text.Regex.String.Unsafe.html#1059" class="Bound">e</a> <a id="1061" class="Symbol">=</a> <a id="1063" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1070" href="Text.Regex.String.Unsafe.html#1053" class="Bound">str</a> <a id="1074" href="Text.Regex.Base.html#2744" class="Function Operator">Regex.∉</a> <a id="1082" href="Text.Regex.String.Unsafe.html#1059" class="Bound">e</a>

<a id="_∈?_"></a><a id="1085" href="Text.Regex.String.Unsafe.html#1085" class="Function Operator">_∈?_</a> <a id="1090" class="Symbol">:</a> <a id="1092" href="Relation.Binary.Definitions.html#5914" class="Function">Decidable</a> <a id="1102" href="Text.Regex.String.Unsafe.html#971" class="Function Operator">_∈_</a>
<a id="1106" href="Text.Regex.String.Unsafe.html#1106" class="Bound">str</a> <a id="1110" href="Text.Regex.String.Unsafe.html#1085" class="Function Operator">∈?</a> <a id="1113" href="Text.Regex.String.Unsafe.html#1113" class="Bound">e</a> <a id="1115" class="Symbol">=</a> <a id="1117" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1124" href="Text.Regex.String.Unsafe.html#1106" class="Bound">str</a> <a id="1128" href="Text.Regex.Derivative.Brzozowski.html#4530" class="Function Operator">Regex.∈?</a> <a id="1137" href="Text.Regex.String.Unsafe.html#1113" class="Bound">e</a>

<a id="_∉?_"></a><a id="1140" href="Text.Regex.String.Unsafe.html#1140" class="Function Operator">_∉?_</a> <a id="1145" class="Symbol">:</a> <a id="1147" href="Relation.Binary.Definitions.html#5914" class="Function">Decidable</a> <a id="1157" href="Text.Regex.String.Unsafe.html#1028" class="Function Operator">_∉_</a>
<a id="1161" href="Text.Regex.String.Unsafe.html#1161" class="Bound">str</a> <a id="1165" href="Text.Regex.String.Unsafe.html#1140" class="Function Operator">∉?</a> <a id="1168" href="Text.Regex.String.Unsafe.html#1168" class="Bound">e</a> <a id="1170" class="Symbol">=</a> <a id="1172" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1179" href="Text.Regex.String.Unsafe.html#1161" class="Bound">str</a> <a id="1183" href="Text.Regex.Derivative.Brzozowski.html#4647" class="Function Operator">Regex.∉?</a> <a id="1192" href="Text.Regex.String.Unsafe.html#1168" class="Bound">e</a>

<a id="Span"></a><a id="1195" href="Text.Regex.String.Unsafe.html#1195" class="Function">Span</a> <a id="1200" class="Symbol">:</a> <a id="1202" href="Text.Regex.Base.html#1449" class="Record">Regex</a> <a id="1208" class="Symbol">→</a> <a id="1210" href="Relation.Binary.Core.html#896" class="Function">Rel</a> <a id="1214" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1221" href="Level.html#521" class="Function">0ℓ</a>
<a id="1224" href="Text.Regex.String.Unsafe.html#1195" class="Function">Span</a> <a id="1229" href="Text.Regex.String.Unsafe.html#1229" class="Bound">e</a> <a id="1231" class="Symbol">=</a> <a id="1233" href="Text.Regex.Search.html#1863" class="Function">Regex.Span</a> <a id="1244" href="Text.Regex.String.Unsafe.html#1229" class="Bound">e</a> <a id="1246" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a> <a id="1250" href="Function.Base.html#6226" class="Function Operator">on</a> <a id="1253" href="Data.String.Base.html#1533" class="Primitive">toList</a>

<a id="1261" class="Comment">-- A match is a string, a proof it matches the regular expression,</a>
<a id="1328" class="Comment">-- and a proof it appears as the right sort of substring.</a>
<a id="1386" class="Keyword">record</a> <a id="Match"></a><a id="1393" href="Text.Regex.String.Unsafe.html#1393" class="Record">Match</a> <a id="1399" class="Symbol">(</a><a id="1400" href="Text.Regex.String.Unsafe.html#1400" class="Bound">str</a> <a id="1404" class="Symbol">:</a> <a id="1406" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1412" class="Symbol">)</a> <a id="1414" class="Symbol">(</a><a id="1415" href="Text.Regex.String.Unsafe.html#1415" class="Bound">e</a> <a id="1417" class="Symbol">:</a> <a id="1419" href="Text.Regex.Base.html#1449" class="Record">Regex</a><a id="1424" class="Symbol">)</a> <a id="1426" class="Symbol">:</a> <a id="1428" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1432" class="Keyword">where</a>
  <a id="1440" class="Keyword">constructor</a> <a id="mkMatch"></a><a id="1452" href="Text.Regex.String.Unsafe.html#1452" class="InductiveConstructor">mkMatch</a>
  <a id="1462" class="Keyword">field</a>
    <a id="Match.string"></a><a id="1472" href="Text.Regex.String.Unsafe.html#1472" class="Field">string</a>  <a id="1480" class="Symbol">:</a> <a id="1482" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
    <a id="Match.match"></a><a id="1493" href="Text.Regex.String.Unsafe.html#1493" class="Field">match</a>   <a id="1501" class="Symbol">:</a> <a id="1503" href="Text.Regex.String.Unsafe.html#1472" class="Field">string</a> <a id="1510" href="Text.Regex.String.Unsafe.html#971" class="Function Operator">∈</a> <a id="1512" href="Text.Regex.Base.html#1525" class="Field">Regex.expression</a> <a id="1529" href="Text.Regex.String.Unsafe.html#1415" class="Bound">e</a>
    <a id="Match.related"></a><a id="1535" href="Text.Regex.String.Unsafe.html#1535" class="Field">related</a> <a id="1543" class="Symbol">:</a> <a id="1545" href="Text.Regex.String.Unsafe.html#1195" class="Function">Span</a> <a id="1550" href="Text.Regex.String.Unsafe.html#1415" class="Bound">e</a> <a id="1552" href="Text.Regex.String.Unsafe.html#1472" class="Field">string</a> <a id="1559" href="Text.Regex.String.Unsafe.html#1400" class="Bound">str</a>
<a id="1563" class="Keyword">open</a> <a id="1568" href="Text.Regex.String.Unsafe.html#1393" class="Module">Match</a> <a id="1574" class="Keyword">public</a>

<a id="search"></a><a id="1582" href="Text.Regex.String.Unsafe.html#1582" class="Function">search</a> <a id="1589" class="Symbol">:</a> <a id="1591" href="Relation.Binary.Definitions.html#5914" class="Function">Decidable</a> <a id="1601" href="Text.Regex.String.Unsafe.html#1393" class="Record">Match</a>
<a id="1607" href="Text.Regex.String.Unsafe.html#1582" class="Function">search</a> <a id="1614" href="Text.Regex.String.Unsafe.html#1614" class="Bound">str</a> <a id="1618" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a> <a id="1620" class="Symbol">=</a> <a id="1622" href="Relation.Nullary.Decidable.Core.html#4793" class="Function">map′</a> <a id="1627" href="Text.Regex.String.Unsafe.html#1716" class="Function">from</a> <a id="1632" href="Text.Regex.String.Unsafe.html#2016" class="Function">to</a> <a id="1635" class="Symbol">(</a><a id="1636" href="Text.Regex.Search.html#9314" class="Function">Regex.search</a> <a id="1649" href="Text.Regex.String.Unsafe.html#1667" class="Function">input</a> <a id="1655" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a><a id="1656" class="Symbol">)</a> <a id="1658" class="Keyword">where</a>

  <a id="1667" href="Text.Regex.String.Unsafe.html#1667" class="Function">input</a> <a id="1673" class="Symbol">=</a> <a id="1675" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1682" href="Text.Regex.String.Unsafe.html#1614" class="Bound">str</a>
  <a id="1688" href="Text.Regex.String.Unsafe.html#1688" class="Function">exp</a> <a id="1692" class="Symbol">=</a> <a id="1694" href="Text.Regex.Base.html#1525" class="Field">Regex.expression</a> <a id="1711" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a>

  <a id="1716" href="Text.Regex.String.Unsafe.html#1716" class="Function">from</a> <a id="1721" class="Symbol">:</a> <a id="1723" href="Text.Regex.Search.html#2502" class="Record">Regex.Match</a> <a id="1735" class="Symbol">(</a><a id="1736" href="Text.Regex.Search.html#1863" class="Function">Regex.Span</a> <a id="1747" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a> <a id="1749" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1752" class="Symbol">)</a> <a id="1754" href="Text.Regex.String.Unsafe.html#1667" class="Function">input</a> <a id="1760" href="Text.Regex.String.Unsafe.html#1688" class="Function">exp</a> <a id="1764" class="Symbol">→</a> <a id="1766" href="Text.Regex.String.Unsafe.html#1393" class="Record">Match</a> <a id="1772" href="Text.Regex.String.Unsafe.html#1614" class="Bound">str</a> <a id="1776" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a>
  <a id="1780" href="Text.Regex.String.Unsafe.html#1716" class="Function">from</a> <a id="1785" class="Symbol">(</a><a id="1786" href="Text.Regex.Search.html#2608" class="InductiveConstructor">Regex.mkMatch</a> <a id="1800" href="Text.Regex.String.Unsafe.html#1800" class="Bound">list</a> <a id="1805" href="Text.Regex.String.Unsafe.html#1805" class="Bound">match</a> <a id="1811" href="Text.Regex.String.Unsafe.html#1811" class="Bound">related</a><a id="1818" class="Symbol">)</a> <a id="1820" class="Symbol">=</a>
    <a id="1826" class="Keyword">let</a> <a id="1830" href="Text.Regex.String.Unsafe.html#1830" class="Bound">eq</a> <a id="1833" class="Symbol">=</a> <a id="1835" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="1839" class="Symbol">(</a><a id="1840" href="Data.String.Unsafe.html#999" class="Function">Stringₚ.toList∘fromList</a> <a id="1864" href="Text.Regex.String.Unsafe.html#1800" class="Bound">list</a><a id="1868" class="Symbol">)</a> <a id="1870" class="Keyword">in</a>
    <a id="1877" href="Text.Regex.String.Unsafe.html#1452" class="InductiveConstructor">mkMatch</a> <a id="1885" class="Symbol">(</a><a id="1886" href="Data.String.Base.html#1566" class="Primitive">fromList</a> <a id="1895" href="Text.Regex.String.Unsafe.html#1800" class="Bound">list</a><a id="1899" class="Symbol">)</a>
            <a id="1913" class="Symbol">(</a><a id="1914" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Text.Regex.Base.html#2223" class="Datatype Operator">Regex._∈</a> <a id="1930" href="Text.Regex.String.Unsafe.html#1688" class="Function">exp</a><a id="1933" class="Symbol">)</a> <a id="1935" href="Text.Regex.String.Unsafe.html#1830" class="Bound">eq</a> <a id="1938" href="Text.Regex.String.Unsafe.html#1805" class="Bound">match</a><a id="1943" class="Symbol">)</a>
            <a id="1957" class="Symbol">(</a><a id="1958" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a> <a id="1964" class="Symbol">(λ</a> <a id="1967" href="Text.Regex.String.Unsafe.html#1967" class="Bound">str</a> <a id="1971" class="Symbol">→</a> <a id="1973" href="Text.Regex.Search.html#1863" class="Function">Regex.Span</a> <a id="1984" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a> <a id="1986" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a> <a id="1990" href="Text.Regex.String.Unsafe.html#1967" class="Bound">str</a> <a id="1994" href="Text.Regex.String.Unsafe.html#1667" class="Function">input</a><a id="1999" class="Symbol">)</a> <a id="2001" href="Text.Regex.String.Unsafe.html#1830" class="Bound">eq</a> <a id="2004" href="Text.Regex.String.Unsafe.html#1811" class="Bound">related</a><a id="2011" class="Symbol">)</a>

  <a id="2016" href="Text.Regex.String.Unsafe.html#2016" class="Function">to</a> <a id="2019" class="Symbol">:</a> <a id="2021" href="Text.Regex.String.Unsafe.html#1393" class="Record">Match</a> <a id="2027" href="Text.Regex.String.Unsafe.html#1614" class="Bound">str</a> <a id="2031" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a> <a id="2033" class="Symbol">→</a> <a id="2035" href="Text.Regex.Search.html#2502" class="Record">Regex.Match</a> <a id="2047" class="Symbol">(</a><a id="2048" href="Text.Regex.Search.html#1863" class="Function">Regex.Span</a> <a id="2059" href="Text.Regex.String.Unsafe.html#1618" class="Bound">e</a> <a id="2061" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="2064" class="Symbol">)</a> <a id="2066" href="Text.Regex.String.Unsafe.html#1667" class="Function">input</a> <a id="2072" href="Text.Regex.String.Unsafe.html#1688" class="Function">exp</a>
  <a id="2078" href="Text.Regex.String.Unsafe.html#2016" class="Function">to</a> <a id="2081" class="Symbol">(</a><a id="2082" href="Text.Regex.String.Unsafe.html#1452" class="InductiveConstructor">mkMatch</a> <a id="2090" href="Text.Regex.String.Unsafe.html#2090" class="Bound">string</a> <a id="2097" href="Text.Regex.String.Unsafe.html#2097" class="Bound">match</a> <a id="2103" href="Text.Regex.String.Unsafe.html#2103" class="Bound">related</a><a id="2110" class="Symbol">)</a> <a id="2112" class="Symbol">=</a>
    <a id="2118" href="Text.Regex.Search.html#2608" class="InductiveConstructor">Regex.mkMatch</a> <a id="2132" class="Symbol">(</a><a id="2133" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="2140" href="Text.Regex.String.Unsafe.html#2090" class="Bound">string</a><a id="2146" class="Symbol">)</a> <a id="2148" href="Text.Regex.String.Unsafe.html#2097" class="Bound">match</a> <a id="2154" href="Text.Regex.String.Unsafe.html#2103" class="Bound">related</a>
</pre></body></html>